<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>花语信箱 · 致敬时刻</title>
<style>
  :root{
    /* ✅ 更协调：深蓝绿夜景 + 柔金 + 低饱和粉/薄荷 */
    --bg0:#0E1B27;
    --bg1:#13283A;
    --bg2:#102231;

    --champ:#F6E6C2; /* champagne highlight */
    --gold:#E8C56A;

    /* sticky palette (muted, coherent) */
    --st1:#FFF1B8;   /* butter */
    --st2:#CFEFD9;   /* mint */
    --st3:#DAD4FF;   /* lavender */
    --st4:#FFD8C8;   /* peach */

    --paper:#F9F4EA;
    --paper2:#F6F0E6;

    --text: rgba(255,255,255,.94);
    --muted: rgba(255,255,255,.72);
    --ink: rgba(10,14,18,.80);
    --ink2: rgba(10,14,18,.62);
  }

  *{box-sizing:border-box}
  html,body{height:100%; margin:0;}
  body{
    overflow:hidden;
    background:
      radial-gradient(1100px 760px at 20% 16%, rgba(246,230,194,.14), transparent 55%),
      radial-gradient(1100px 820px at 82% 22%, rgba(255,168,190,.10), transparent 58%),
      radial-gradient(1000px 900px at 56% 92%, rgba(207,239,217,.10), transparent 62%),
      linear-gradient(160deg, var(--bg0), var(--bg1) 55%, var(--bg2));
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans SC", "PingFang SC", "Microsoft YaHei", sans-serif;
    color:var(--text);
  }
  canvas{position:fixed; inset:0; width:100%; height:100%; display:block;}

  /* ✅ 新标题：无 emoji，更干净、更舞台 */
  .topTitle{
    position:fixed;
    top:16px; left:0; right:0;
    display:flex;
    justify-content:center;
    pointer-events:none;
    padding:0 16px;
  }
  .titleWrap{
    text-align:center;
    padding:14px 18px 12px;
    border-radius:14px; /* 这里是“UI牌”，不是纸张，可圆角，观感更高级 */
    background: rgba(255,255,255,.06);
    border: 1px solid rgba(255,255,255,.12);
    backdrop-filter: blur(12px);
    box-shadow: 0 18px 60px rgba(0,0,0,.32);
    max-width: min(760px, 92vw);
  }
  .titleMain{
    font-family: "Noto Serif SC","Songti SC","STSong","SimSun",serif;
    font-weight: 800;
    letter-spacing: .18em;
    font-size: 18px;
    line-height: 1.2;
    color: rgba(255,255,255,.92);
  }
  .titleSub{
    margin-top:6px;
    font-size:11px;
    letter-spacing:.28em;
    color: rgba(255,255,255,.68);
    font-weight:700;
  }
  .titleRule{
    width: 54px;
    height: 1px;
    margin: 8px auto 0;
    background: linear-gradient(90deg, transparent, rgba(232,197,106,.70), transparent);
    opacity:.9;
  }

  /* One main button */
  .btnBar{
    position:fixed;
    left:0; right:0; bottom:26px;
    display:flex; justify-content:center;
    padding: 0 16px;
    pointer-events:none;
  }
  .btn{
    pointer-events:auto;
    border:none;
    padding:14px 22px;
    border-radius:16px;
    background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.07));
    border:1px solid rgba(255,255,255,.18);
    color: rgba(255,255,255,.94);
    font-weight:900;
    letter-spacing:.35em;
    cursor:pointer;
    box-shadow: 0 20px 70px rgba(0,0,0,.35);
    transition: transform .10s ease, border-color .2s ease, background .2s ease, opacity .2s ease;
    user-select:none;
    min-width: 160px;
    text-align:center;
  }
  .btn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.30); }
  .btn:active{ transform: translateY(0px) scale(.99); }
  .btn[disabled]{ opacity:.55; cursor:not-allowed; transform:none; }

  /* ✅ Paper stage: 信件必须“方角+纸纹理” */
  .letterStage{
    position:fixed; inset:0;
    display:grid;
    place-items:center;
    pointer-events:none;
    /* ✅ 给底部按钮留出安全区，避免信纸/滚动内容被遮挡 */
    padding: 0 0 96px;
  }
  .paper{
    width:min(860px, 92vw);
    height:min(600px, 74vh);
    border-radius: 6px; /* ✅ 方角纸张：只留极小圆角（几乎方角） */
    overflow:hidden;
    opacity:0;
    transform: translateY(26px) scale(.988);
    filter: blur(2px);
    transition: opacity .35s ease, transform .45s cubic-bezier(.2,.9,.2,1), filter .35s ease;
    box-shadow: 0 40px 120px rgba(0,0,0,.52);
    border:1px solid rgba(0,0,0,.12);
    background:
      /* 纸张纤维纹理 */
      repeating-linear-gradient(0deg, rgba(0,0,0,.018) 0 1px, transparent 1px 6px),
      repeating-linear-gradient(90deg, rgba(0,0,0,.012) 0 1px, transparent 1px 7px),
      radial-gradient(900px 560px at 30% 20%, rgba(255,255,255,.72), transparent 55%),
      linear-gradient(180deg, var(--paper), var(--paper2));
  }
  .paper.show{
    opacity:1;
    transform: translateY(0px) scale(1);
    filter: blur(0px);
  }
  .paperInner{
    height:100%;
    padding:24px 26px 18px;
    display:flex;
    flex-direction:column;
    gap:14px;
  }
  .paperTitle{
    display:flex; align-items:flex-end; justify-content:space-between; gap:12px;
    padding-bottom:10px;
    border-bottom:1px solid rgba(0,0,0,.10);
  }
  .paperTitle b{
    font-size:18px;
    color: rgba(15,20,28,.88);
    letter-spacing:.4em;
    font-family: "Noto Serif SC","Songti SC","STSong","SimSun",serif;
    font-weight:800;
  }
  .paperTitle span{
    font-size:12px;
    color: rgba(15,20,28,.52);
    letter-spacing:.12em;
  }
  .paperBody{
    flex:1;
    overflow:auto;
    padding-right:10px;
    color: rgba(15,20,28,.88);
    line-height:2.02;
    font-size:19px;
    white-space:normal;
    text-indent: 0;
    font-family:
      "Kaiti SC","STKaiti","KaiTi",
      "Segoe Script","Bradley Hand","Comic Sans MS",
      cursive, system-ui;
    /* 兼容性滚动条样式 */
    scrollbar-width: thin; /* Firefox */
    scrollbar-color: rgba(15,20,28,.25) rgba(15,20,28,.08); /* Firefox */
    -ms-overflow-style: -ms-autohiding-scrollbar; /* IE/Edge */
    overflow-y: auto; /* 确保垂直滚动条可见 */
    scrollbar-gutter: stable;
  }
  .paperBody .letterContent{
    padding-bottom: 10px;
  }
  .paperBody p{
    margin: 0 0 14px;
    text-indent: 2em;
  }
  .paperBody p.salutation{
    text-indent: 0;
    margin-bottom: 10px;
    font-weight: 800;
    letter-spacing: .08em;
    font-family: "Noto Serif SC","Songti SC","STSong","SimSun",serif;
    color: rgba(15,20,28,.84);
  }
  .paperBody .letterEnd{
    margin-top: 18px;
    padding-top: 14px;
    border-top: 1px dashed rgba(15,20,28,.18);
    text-align: center;
    text-indent: 0;
  }
  .paperBody .letterTo{
    display: inline-block;
    padding: 6px 10px;
    border-radius: 999px;
    background: rgba(232,197,106,.18);
    border: 1px solid rgba(232,197,106,.28);
    color: rgba(15,20,28,.74);
    font-weight: 800;
    letter-spacing: .10em;
    font-size: 12px;
  }
  .paperBody .letterFrom{
    margin-top: 12px;
    font-family: "Noto Serif SC","Songti SC","STSong","SimSun",serif;
    font-weight: 900;
    letter-spacing: .18em;
    color: rgba(15,20,28,.72);
  }
  .paperBody::-webkit-scrollbar{ width:10px; }
  .paperBody::-webkit-scrollbar-track{
    background: rgba(15,20,28,.06);
  }
   .paperBody::-webkit-scrollbar-thumb{
     background: rgba(15,20,28,.22);
     border:2px solid rgba(15,20,28,.06);
   }

   /* 确保在所有 Webkit 浏览器中滚动条可见 */
   .paperBody {
     overflow: auto;
     -webkit-overflow-scrolling: touch;
   }

   /* Webkit 滚动条样式 */
   .paperBody::-webkit-scrollbar {
     width: 10px; /* 滚动条宽度 */
   }

   .paperBody::-webkit-scrollbar-track {
     background: rgba(15,20,28,.06); /* 滚动条轨道背景 */
   }

   .paperBody::-webkit-scrollbar-thumb {
     background: rgba(15,20,28,.22); /* 滚动条滑块 */
     border-radius: 5px; /* 滑块圆角 */
     border: 2px solid rgba(15,20,28,.06); /* 滑块边框 */
   }

  /* Subtle vignette */
  .vignette{
    position:fixed; inset:0;
    pointer-events:none;
    background:
      radial-gradient(1200px 700px at 50% 45%, transparent 35%, rgba(0,0,0,.22) 78%, rgba(0,0,0,.40) 100%);
    opacity:.56;
  }

  /* 确保信件可交互 */
  .paper, .paperInner {
    pointer-events: auto !important;
  }

  /* 音乐控制按钮样式 */
  .musicControl {
    position: fixed;
    bottom: 26px;
    left: 26px;
    z-index: 1000; /* 确保在最上层 */
  }
  .musicBtn {
    pointer-events: auto;
    border: none;
    background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.07));
    border: 1px solid rgba(255,255,255,.18);
    color: rgba(255,255,255,.94);
    font-size: 20px;
    width: 48px;
    height: 48px;
    border-radius: 50%; /* 圆形按钮 */
    cursor: pointer;
    box-shadow: 0 10px 30px rgba(0,0,0,.35);
    transition: transform .10s ease, border-color .2s ease, background .2s ease, opacity .2s ease;
    user-select: none;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .musicBtn:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.30); }
  .musicBtn:active{ transform: translateY(0px) scale(.99); }
</style>
</head>
<body>
<audio id="bgm" src="my_background.mp3" autoplay loop preload="auto" volume="0.5"></audio>
<canvas id="c"></canvas>
<div class="vignette"></div>
<!-- ✅ 标题 -->
<div class="topTitle">
  <div class="titleWrap">
    <div class="titleMain">花 语 信 箱</div>
    <div class="titleRule"></div>
    <div class="titleSub">社区服务部 · 我们的例会</div>
  </div>
</div>

<!-- ✅ 信件 -->
<div class="letterStage">
  <div class="paper" id="paper" aria-hidden="true">
    <div class="paperInner">
      <div class="paperTitle">
        <b id="paperHead">感 谢 信</b>
        <span id="paperHint">（领导喊停后抽取）</span>
      </div>
      <div class="paperBody" id="paperBody"></div>
    </div>
  </div>
</div>

<!-- ✅ 按钮 -->
<div class="btnBar">
  <button class="btn" id="mainBtn">开 始</button>
</div>

<!-- ✅ 音乐控制按钮 -->
<div class="musicControl">
  <button class="musicBtn" id="musicToggleBtn">▶</button>
</div>

<script>
/* ========= 把这里替换为真实问卷内容 ========= */
// 送给自己的“弹幕式”留言（背景墙上方缓慢飘过）
const SELF_MESSAGES = [
  "这一年，步履不停，在工作的责任里坚守，在家庭的暖意里奔赴，也为自己的热爱留了空间。不算最好，却已拼尽全力。往后，好好爱自己，照顾好身体与心灵，我值得所有的美好。TO 老己。",
  "辛苦了老己，这一年你干的不错！遇到了很多挫折和磨难，但是回过头来看，你都处理的很好，是一个能抗事儿的大人了！明年继续加油，不忘初心，保持努力，保持向上！",
  "泰康三年，感恩平台，赋予我施展能力的空间；感恩领导(朱思斯女士)(易红女士)给予我信任和谆谆教诲；感恩自己，拥有不断前进自我挑战的勇气。挥手告别2025年，一切刚刚好！携手拥抱2026年，又是新征程！",
  "雪婷主管 “您这‘定海神针’的功力，明年还得继续借力啊！”",
  "致所有可爱的伙伴们：忙忙碌碌又一年，感恩并肩的每一位伙伴，感谢每一次并肩的默契，每一份全力以赴的担当。新岁新程，愿我们继续携手，步履不停，共创更精彩的一年！",
  "南南小朋友，过去的一年你辛苦了，但是你很棒，新的一年继续加油！",
  "瑶瑶，这一年辛苦了，感恩一路同行！新的一年，愿我们都平安喜乐，事事顺心！",
  "这一年辛苦各位并肩作战的伙伴！感谢大家日复一日的坚守和付出，新岁愿我们依旧同心同行，万事顺意，平安喜乐！",
  "十分感谢您一年来的悉心指导，您身上坚定的目标感和做事的章法，是我最宝贵的学习榜样，也让我在工作中不断明晰方向、提升自己，感恩相伴！"
];

const CUSTOM_LETTERS = [
  {
    to: "运康团队",
    from: "王家博",
    salutation: "亲爱的伙伴们：",
    paragraphs: [
      "2026年新岁启幕，回望2024年5月刚接管团队，与大家并肩前行近二十个月，心中满是感恩与感动。",
      "初接团队时的忐忑，皆因你们的包容接纳、全力支持而消散。从最初的工作磨合，到如今的协作默契，我们始终同心聚力，把运动健康管理服务做细、做实、做好。这一路，我真切见证着每位伙伴的成长与蜕变，你们深耕专业、用心服务长辈，遇事勇挑重担、并肩攻坚克难，每一份坚守与付出，我都看在眼里、记在心上。",
      "我们用汗水浇灌收获，从步履维艰到实现业绩突破增长，每一份成果的背后，都是大家的全力以赴，这份荣光，属于运康团队的每一个人！",
      "感恩一路同行，幸有彼此支撑。新的一年，愿大家初心不改，望继续携手并肩、聚力前行，再创运康新佳绩！同时，提前恭祝长辈们、社区领导、伙伴们，大家新年顺遂，阖家安康，万事胜意！",
    ]
  },
  {
    to: "4516张祖勋叔叔张世兴阿姨",
    from: "虞祥杰",
    salutation: "",
    paragraphs: [
      "非常感谢你们对我的认可与鼓励。每次想到张叔叔和阿姨在信中写下的那些话语，我都感到格外温暖，也备受鼓舞。能够为你们服务，是我的荣幸。",
      "叔叔阿姨在信中特别提到，我能无微不至地关心你们，甚至及时发现并解决那些你们自己都未曾留意的问题，让你们感受到被放在心上。这番话让我深深感动，也让我更加坚信——管家的工作，正是要把长辈的事当作自己的事，像家人一样为你们着想。",
      "用心做事、真诚待人，在日常点滴中识别风险、化解担忧，让叔叔阿姨住得舒心、放心、安心，这正是我的职责所在。尤其让我感到肩上有光的是，当家人不在身边时，我能成为你们可以依靠的“身边人”。这份信任，是我扎根养老服务工作中最珍贵的动力。",
      "再次感谢你们的肯定。我会继续带着这份温暖与责任，努力做好每一件事，不辜负你们的信任。衷心祝愿你们健康、快乐！"
    ]
  },
  {
    to: "李莹露",
    from: "匿名",
    salutation: "亲爱的主管：",
    paragraphs: [
      "提笔写下这封信时，心中满是温暖与敬意。回望与你共事的时光，最珍贵的莫过于你始终懂得我们工作中的不易，总能在我们迷茫委屈时，成为最坚实的后盾；在我们遭遇困境时，给予最有力的支持。这份知遇之恩与悉心呵护，让我时常感念不已。",
      "还记得那次医保报销引发的风波，至今想起仍能清晰感受到当时的委屈与愤怒。原本已沟通妥当的验真单打印事宜，医保窗口突然临时变卦，不仅要求我们额外承担打印工作，还未与任何领导协商，便在居民面前直接安排管家送发票，全然不顾我们的工作负荷与实际难处。那种不被尊重、莫名增加负担的委屈，让我一度难以平复情绪，甚至担心带着负面状态影响后续工作，或是与其他部门产生不必要的矛盾。",
      "就在我满心沮丧地向你倾诉后，你没有丝毫敷衍，第一时间先耐心安抚我的情绪，让我感受到被理解、被看见的暖意。更让我感动的是，你没有让我独自面对这份不公，而是亲自跑到医保窗口沟通。你条理清晰地说明管家日常工作的繁杂与不易，强调我们本是出于配合的善意提供协助，双方应相互理解、彼此尊重，不应未经协商便随意增加额外工作。你的据理力争，不仅为我们卸下了不合理的负担，更维护了我们的尊严，让我心中的怨气与委屈瞬间消散。",
      "你身上最可贵的，不仅是为下属遮风挡雨的担当，更在于你总能敏锐捕捉我们的情绪波动，用温柔而坚定的力量化解我们的负面情绪。你从不会忽视任何一个人的感受，更善于发现每个人身上的闪光点，将我们的优势精准运用到工作中，让团队里的每一个人都能感受到被重视、被认可，从而满怀热忱地投入工作。",
      "正是因为有你这样的领导，我们才能在和谐包容的工作氛围中专注于本职，无需为额外的纷扰分心；正是因为你的理解与支持，我们才能鼓起勇气直面工作中的难题，毫无后顾之忧地奋力前行。你用实际行动诠释了何为“良师益友”，用温暖与担当为我们构建了一个充满归属感的团队。",
      "千言万语道不尽心中的感激。愿往后岁月，你工作顺遂、万事胜意，始终被温柔与美好环绕。而我们也会带着你的信任与期许，在工作中继续全力以赴，不辜负你的悉心栽培与默默守护。"
    ]
  },
  {
    to: "孙前劢",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "骨痛里开出的花——记我心疼的孙阿姨",
      "在楚园的时光里，孙阿姨是最让我心疼，也最让我敬佩的长辈。",
      "来楚园之前，阿姨在家休养了整整一年，初到时满是不情愿。严重的骨质疏松，成了缠在她身上的枷锁，起初还能勉强行走，后来全身钻心的疼痛，渐渐磨去了她脸上的笑意，让她变得消沉，生活能力也大不如前。身边人都劝她转到护理楼，能得到更周全的照护，可阿姨却执拗地摇头，靠着止疼针硬扛着疼痛，执意要靠自己的力量生活。",
      "她的“倔强”，藏在一个个小巧思里。够不着高处的衣物，她就亲手做了个便捷小柜子，把常用的东西摆得整整齐齐；弯腰捡东西费劲，她便网购了捡物夹，再也不用为掉在地上的小物件犯愁；草坪晾晒、衣物清洗不方便，她就掐着保洁打扫的时间，同步完成洗衣晾晒，等保洁结束时再顺手叠好收进柜中。从始至终，她都坚持“自己的事情自己做”，不愿麻烦任何人。",
      "如今的孙阿姨，早已不是当初那个消沉的模样。每天，她能自己下楼打餐，能慢悠悠地在园区散步，镜子前时常能看见她收拾打扮的身影，还会照着自己的心意，把衣服、鞋子改得合心意又别致。更让人惊喜的是，瘦瘦小小的她，竟推着轮椅去上了手机课、魔方课，回到家还对着视频一遍遍练习魔方手法。",
      "看着她脸上舒展的笑容，看着她为了生活绞尽脑汁想办法的模样，我总忍不住心疼她强忍疼痛的坚持，却又深深敬佩她骨子里那股不服输的独立劲儿。病痛或许能困住她的身体，却永远锁不住她对生活的热爱与倔强。这朵在骨痛里奋力绽放的花，美得格外动人。"
    ]
  },
  {
    to: "何梦瑶",
    from: "八号楼及十号楼主管及全体管家",
    salutation: "致8＆10号楼的两位主管与管家伙伴们：",
    paragraphs: [
      "在实习期间，我时刻感受到团队的温暖与包容，在此衷心向大家表示感谢。初入岗位时，我对各项工作都十分生疏，是杜主管和胡主管耐心教导、悉心指引，是各位小伙伴包容我的不足，让我快速融入了这个有温度的集体。从第一次入户的星星的全程带领与细致讲解，到第一次与家属沟通时的佩姐的全力支持并帮助我梳理思路，再到第一次迎接新居民时的双琪姐的暖心鼓励与不吝肯定，每一个关键的时刻，都有你们的陪伴与帮扶。满丽姐、姗姗、彩霞、菲雨像一场及时雨，在我手忙脚乱时伸出援手，帮助我解决问题；还有曾经的十号楼管家许克涛，在我对十号楼尚不了解的情况下，带我慢慢熟悉十号楼的居民，告诉我与长辈们交流时需要注意的细节。",
      "在大家的帮助下，我逐渐熟悉了工作流程，也慢慢找到了工作的节奏。未来我会带着这份温暖与鼓励，认真做好每一项工作，向各位前辈学习，努力成为更专业的管家，与团队并肩同行，共同为居民提供更优质的服务。再次感谢大家的包容、教导与支持！" 
    ]
  },
  {
    to: "",
    from: "我的团队",
    salutation: "李莹露",
    paragraphs: [
      "一年的时光悄然而逝，我要感谢和我朝夕相处的伙伴们，我可爱的莎莎，瑶瑶，南南，鑫，满丽，祥杰，克涛，是你们的陪伴，让我觉得工作也可以这么美好；是你们的包容，让我可以心无旁骛的去开拓，让我更加坚定团队的力量！2025，我们相拥相伴，2026，我们高歌奋进！"
    ]
  },
  {
    to: "4516张祖勋叔叔张世兴阿姨",
    from: "虞祥杰",
    salutation: "",
    paragraphs: [
      "非常感谢你们对我的认可与鼓励。每次想到张叔叔和阿姨在信中写下的那些话语，我都感到格外温暖，也备受鼓舞。能够为你们服务，是我的荣幸。",
      "叔叔阿姨在信中特别提到，我能无微不至地关心你们，甚至及时发现并解决那些你们自己都未曾留意的问题，让你们感受到被放在心上。这番话让我深深感动，也让我更加坚信——管家的工作，正是要把长辈的事当作自己的事，像家人一样为你们着想。用心做事、真诚待人，在日常点滴中识别风险、化解担忧，让叔叔阿姨住得舒心、放心、安心，这正是我的职责所在。",
      "尤其让我感到肩上有光的是，当家人不在身边时，我能成为你们可以依靠的“身边人”。这份信任，是我扎根养老服务工作中最珍贵的动力。",
      "再次感谢你们的肯定。我会继续带着这份温暖与责任，努力做好每一件事，不辜负你们的信任。",
      "衷心祝愿你们健康、快乐！"
    ]
  },
  {
    to: "我的家人",
    from: "胡佩",
    salutation: "",
    paragraphs: [
      "在独自筹备年会的那些日子里，我像一只不停旋转的陀螺。那天傍晚，我拖着被流程、采购、物料压得发沉的双腿回家，屋里亮着灯，却像照不进心里。为了让自己“活”过来一点，我轻声问：“宝贝，愿意陪妈妈去散个步吗？”她雀跃地牵起我的手，小小的掌心滚烫。",
      "夜风有点凉，我却仍在走神——会场布置、领导座次、暖场音乐……一堆未完成的细节像弹幕在脑海里刷屏。孩子摇我的手臂：“妈妈，你最近是有什么事吗？”我叹了口气：“对呀，妈妈在筹备一场年会，很紧张，担心做不好。”",
      "她停下来，抬头看我，路灯落进她的瞳孔里，像两颗小小的月亮。“没事的，妈妈，你要自豪一点。”",
      "我愣住：“怎么样才能自豪呢？”",
      "她踮起脚，小手捧住我的脸，声音软却笃定：“你要想到——宝贝一直在为你加油。”",
      "那一瞬，夜风忽然有了温度，眼眶毫无防备地就热了。我蹲下去，把她紧紧搂进怀里，听见自己心跳的声音——原来，真正的掌声不是来自舞台，而是来自怀里这个小小孩童。",
      "这一年，同事离职没来得及当面感谢、想好的话语却错过表达的机会，偶有迷茫和遗憾，可就在这条回家的小路上，被一句“我为你加油”轻轻抚平，圆满得发亮。",
      "谢谢我的家人，用不动声色的温柔，为我撑起辽阔后台；更谢谢这个小小人儿，让我懂得：所谓“自豪”，不是完美落幕，而是有人在灯火深处，始终把我当成最亮的星。"
    ]
  },
  {
    to: "杜双琪",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "来到楚园已经两个月了，这里的工作氛围很温馨，是一个有爱的大家庭，我想感谢的人很多（感谢胡佩主管日常工作的指点和帮助、感谢管家小伙伴工作中的热心分享和困惑解答、感谢环境部的异常情况提醒和协助、感谢运维保障部的及时回应和处理），但最想感谢的是我的杜双琪主管。",
      "她很可爱，很有亲和力，在工作中很认真细心，很有责任感，在她的带教下总能保持持续主动学习的状态，她会在我还有些懵圈的时候告诉我“没关系，刚开始都这样，时间久了都会的，我再教你一遍”，在我不知道如何做的时候亲自带我一起完成工作，也会在我有些低落时告诉我“没关系，慢慢来，不要过度压力，保持一颗平常心”，这种时候总能缓解我的焦虑情绪；在生活上她是一个很温暖的人，性格很温和，也会闲聊很多，和她相处几乎感觉不到压力和拘束，会让我想主动和她拉近彼此的距离。",
      "还没来到八十号楼的时候，我总是会很担心、很焦虑，时常在想“我的主管是一个什么性格的人？她会不会不喜欢我？工作中我提出很简单的问题时，她会不会觉得我很呆？她会不会有耐心、很认真的教我呢？这里的工作氛围是温馨的还是冷漠的呢……”来到这里的第一周，双琪主管全程带着我一起工作学习，当一个全自动的小跟班，这很大程度上缓解了我在陌生工作环境下的焦虑和不安，让我很快的融入到这个小团队，我觉得这是一个有爱的小团队，在这里工作我很开心，很想感谢双琪主管，在此祝您每天开开心心，家庭幸福美满，生活顺顺利利，事业步步高升，新年万事顺意，心想事成！"
    ]
  },
  {
    to: "张雪婷",
    from: "匿名",
    salutation: "亲爱的雪婷：",
    paragraphs: [
      "非常感谢您一直以来在工作中给予的悉心指导与深切关怀。每当我在工作推进中遇到挑战时，您总能耐心指点、及时把关，帮助我理清思路、明确方向；在忙碌之余，也总能感受到您对我们团队成员的体贴与照护。您以丰富的经验为我们引路，又以实际的行动支持我们成长，让我不仅提升了专业能力，更学到了务实担当的工作态度。",
      "能跟随您学习并一起共事，我深感荣幸。未来我将继续努力，不负您的期望与信任。",
      "再次由衷感谢！"
    ]
  },
  {
    to: "朱思斯",
    from: "罗艳芳",
    salutation: "",
    paragraphs: [
      "朱经理，一直想跟您说声谢谢！在工作里，你总耐心提点我的不足、指引成长方向，给了我超多尝试和突破的支持，让我一步步变得更成熟；不管是日常工作还是出差在外，您总把大家放在心上，惦记着给大家带好吃的、和暖心小惊喜，像大姐姐一样细心呵护着部门里的每一个人，让我们在温暖的氛围里一起做事、一起进步。能在您的带领下工作真的特别幸运，感恩一路有您的关照和指引，往后也会继续跟着您好好干，不辜负您的用心栽培～"
    ]
  },
  {
    to: "吉甜甜",
    from: "李翔羽",
    salutation: "",
    paragraphs: [
      "我想感谢我们活动部的文娱活动师也是我的带教老师吉甜甜。自从我七月份入职以来，甜甜姐对我非常照顾。有很多事情都是主动来教我，并不是敷衍了事。还会主动问我有没有哪里不懂，最近工作怎么样。我有哪些遗忘的事情她也会提醒我。也会把我的事情放在心上。除了教我之外她自己的工作做的也非常的认真负责，从不偷懒。也一致获得了长辈们的好评。特别感谢在我刚毕业的时候遇到了一个这么好的带教老师。是我的幸运！"
    ]
  },
  {
    to: "胡佩",
    from: "匿名",
    salutation: "亲爱的佩姐：",
    paragraphs: [
      "夜深了，辗转反侧间这些话还是想跟你说。知道你在后台能看见所有留言，这条是专程写给你的——希望能给正在为年会奔忙的你抚平一丢丢压力。",
      "真的，由衷地佩服你。看着你一个人扛起整个年会的筹备，从策划到采买，从协调到落地，独自承担了多大的压力。如果有什么我能分担的，请一定一定告诉我。哪怕只是跑跑腿、理理发票，我也想和你一起，把重担变得轻一些。",
      "但是，我更想对你说，别对自己要求那么高，交到你手上的事，总要做的极致。这让你闪闪发光，却也让你独自扛着太多重量。佩姐，想悄悄对你说，其实适当“放放水”也是可以滴。拉长时间来看，这不过是无数万千工作中一项，无论最终呈现得是否完美，它都有意义。你的能力，你的光芒，早已在点滴日常中可见。它们不需要依附任何外在的评价，也不必通过完美的结果来证明。你本身，就是美好存在。佩姐，那碗雨夜的馄饨，是我今年吃过最暖的一顿饭，谢谢你。所以佩姐，别忘了照顾好自己是首位，放轻松冲冲冲，有啥需要吱一声。"
    ]
  },
  {
    to: "高莉",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "高主管，今天借着年会，好好跟您道一声感谢～",
      "您的专业能力，是团队最坚实的底气。您对工作的每一项标准、每一个细节都精准把控，无论是管家服务的优化、团队工作的统筹，还是各类突发问题的应对，您都能判断问题核心，给出最贴合实际的解决方案，让我们在开展工作时始终有方向。您始终有着清晰的思维逻辑，面对繁杂的工作事务，总能快速梳理、提炼重点，将各项工作安排得井井有条，从不会因事务琐碎而乱了节奏；而在面对关键抉择和突发状况时，您的果敢决断更让我们倍感安心，从不犹豫拖沓，总能以精准的判断快速出最优方案。",
      "工作中，您是领路人。您会将自己的工作方法毫无保留地分享给我们，在我们梳理工作思路时给予精准点拨，在我们遇到困难时耐心指导。",
      "一路走来，感恩您的信任支持，感恩您的带领，这对凝聚起整个团队有着很大的作用。",
      "最后，衷心祝您新的一年万事顺遂、安康如意！愿我们的团队，在您的引领下凝心聚力，把温暖的养老服务做得更细更优，一路向阳前行！"
    ]
  },
  {
    to: "王家博",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "感谢王家博主管🤙🤙🤙，祝你步步高升，马到成功！"
    ]
  },
  {
    to: "王家博",
    from: "王慧",
    salutation: "",
    paragraphs: [
      "博哥，岁末辞旧，回望这一年的工作，心中满是感恩。特别感谢您始终为团队考量，凡事考虑周到，总能提前为我们规避工作难题、扫清执行障碍；在我遇到工作压力和难题时，您更是主动站出来、悉心指导，还始终记挂着团队的切身利益，尽心尽力为我们争取应有的保障和机会。值此年末，谨向您致以最诚挚的感谢和新年祝福，祝您工作顺遂、阖家幸福、万事胜意！"
    ]
  },
  {
    to: "李莹露",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "提笔时，感觉风中的腊梅送来一缕寒香，正如您平日给予的指引，与严峻处显温暖，在静默中蕴深远，让我们学会在沉淀中散发自己的光芒。这一年我尤其感恩您在日常工作中的授权与信任中，给予的包容与契机。您常说服务是心的艺术，而您以身作则的担当，锐利又温暖的眼界，恰似一盏灯，既照亮前路，也让我们学会了自己提灯前行。感谢您在严格要求中藏着的期待，在承担责任时挺直的肩膀。"
    ]
  },
  {
    to: "方欣姐，嘉乐姐，李月姐，睿洁，高莉姐，胡佩姐",
    from: "彭熙雅",
    salutation: "",
    paragraphs: [
      "第一天过来楚园实习的时候还很紧张，但我们服务部的氛围真的太好了~大家都是超级无敌温柔的人，原本以为我呆呆的会被骂之类的但换来的一直是支持和帮助。",
      "感谢社工办公室的前辈们带我熟悉业务、帮我一次次修改我还不会写的文书，一遍遍在长辈面前介绍我，感谢大家在我身体不舒服时候的关心，感谢大家一直给我投喂小零食（睿洁每天给我发两个饼干qwq）！！",
      "以及写代码和剪辑都很有趣。看见自己写的这个用来抽奖的小网页能被用在年会上超级高兴！",
      "希望接下来的日子也能和大家一起创造美好的回忆！( •̀ ω •́ )"
    ]
  },
  {
    to: "活动部",
    from: "匿名",
    salutation: "致活动部全体成员：",
    paragraphs: [
      "时光的卷轴徐徐收拢，当我们驻足回望这一年由我们共同写下的篇章，心中涌动的首先是深深的感激。感谢你们，是你们让每一个平凡的日子，因创意与汗水而变得星光璀璨。",
      "每一次活动的华彩背后，是你们将“不可能”的草图，一笔一划变为现实的蓝图。从最初的灵光乍现，到策划案上密密麻麻的批注；从物资筹备的琐碎繁杂，到现场布置的精雕细琢——我知道，那华丽舞台的每一处光影，都凝结着你们默默调试的心血；那顺畅流程的每一秒衔接，都源自你们反复推演；你们用双手搭建起的，远不止是场景与动线，更是一个个让人沉浸、感动、欢笑的瞬间宇宙。那些掌声与笑容，是给你们最好的加冕。",
      "感谢你们毫无保留的才华，让每个创意都落地生花；感谢你们坚韧不拔的“轴劲儿”，让每个细节都趋于完美；更感谢你们始终如一的热情与并肩作战的默契。能与这样一群浪漫的“造梦者”和务实的“执行家”同行，是我莫大的荣幸。",
      "旧章已谱，新篇将启。愿我们珍藏这份共同铸造的荣光与情谊，继续以赤诚为笔，以热爱为墨，去书写下一个更加磅礴绚丽的四季。",
      "衷心祝愿大家！",
      "愿我们永远如今日般，眼里有光，脚下有风。",
      "此致",
      "敬礼！"
    ]
  },
  {
    to: "前台宝子们",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "这些年来，前台的伙伴来的来去的去，我们在不知不觉中一起走过了一个又一个春夏秋冬。那些平凡的日子，因为有你们变得分外珍贵。",
      "大家每个人都是一颗星星，身上都有属于自己的闪光点：有的人默默付出、从不张扬；有的人在关键时刻扛起重担；有人用细心和耐心温暖着身边的每一个人。但惭愧的是，因为我不善言辞，也不太会表达，没能让更多人看到你们的努力与优秀。",
      "即便如此，你们包容了我的缺点我的不足，我们依然互相信任，互相支持，处出了超越同事的珍贵友谊。一路相伴一路学习，我也会努力学会更好地表达，学会把你们的好、你们的付出、你们的光芒，更勇敢、更真诚地传递出去。希望在接下来的日子里，我们还能继续并肩前行，一起经历更多的四季更迭，一起见证的更多繁花盛开的花路！",
      "爱你们，mua mua muaつ♡⊂"
    ]
  },
  {
    to: "社工伙伴们",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "在楚园工作的这段时间里，我最想感谢的就是社工团队的每一个伙伴。",
      "在我来楚园的第一天，对于周围的一切都感到很陌生很拘谨，欣姐带着我熟悉园区环境与基本情况，月姐热情给我介绍工作内容，嘉乐姐在回来之后也对我十分关心，从工作到学习都给我了很多帮助。最初跟着欣姐从上门拜访中学习，到现在能够独立完成入户工作，这期间的每一点进步，都离不开社工伙伴的耐心指导与鼓励。还记得最开始我什么都不会，就跟着大家一起入户，大多数时候都是作为一个旁观者，看着大家怎么和长辈聊家常，又如何向长辈清楚解释沟通书的相关内容。在这些看似平常的聊天与沟通中，我也逐渐意识到了，社工的入户工作并不是简单的完成任务，而是带着尊重和耐心的真诚陪伴。",
      "到真正开始独立工作后，我总是会担心自己会做不好，或者在跟长辈的沟通中会不小心说了不太合适的话语，但伙伴们总是会给我很多鼓励与支持。面对各种各样的突发情况以及没有预料到的长辈们的疑问，我常常感到手足无措。但庆幸的是，无论我遇到什么样的问题，只要开口请教，大家都会耐心为我解答，同时还附带很多细节上的小经验，包括怎么和长辈开启话题拉家常，又需要关注哪些非言语方面的小细节，帮我跨过了一个又一个新手期的障碍。",
      "特别特别感谢社工伙伴们，让我初入职场就感受到了特别多的温暖与鼓励！"
    ]
  },
  {
    to: "李心怡 雷创创",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "致我的两个宝藏女孩～",
      "第一位是文娱部的开心果，也是我的第一个徒弟，初见时扎着俏皮丸子头满是青涩，两年时光悄然蜕变，如今利落马尾加身，多了成熟稳重，可爱却分毫未减。往后工作愿你保持热忱，学无止境步履不停，稳步向上，薪资也节节攀升，我爱你每一天～",
      "第二位是我爱爱的文娱伙伴，总顶着精致好看的头花，穿搭妆容样样惊艳，满眼皆是赏心悦目，千言万语只剩一句又一句的美女赞叹。并肩共事两年有余，我们早已超越同事，成为彼此最要好的挚友，愿往后岁月，你心之所向皆能如愿，万事顺意，一路繁花～",
      "怕你们不知道是谁写的 我 我 田 苗 苗"
    ]
  },
  {
    to: "我超棒的领导同事们",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "2025年10月份开始我觉得我的天塌啦，一场小车祸导致我左腿受伤，和港澳游、海南游say bye-bye了，开始我长达三个月的艰难康复历程。要感谢的人太多啦，感谢星、彩虹和鱼陪我去急诊 那时我觉得我是这世界上最幸福的人儿，感谢公司和部门在我带伤上班期间为我提供的优待，感谢领导为我协调了一个“vvvip”过渡住所，感谢欣姐、月月、睿洁坚持轮流帮我打饭，感谢慧子姐在我焦虑腿伤康复问题时给我提供的科学答疑，还有阿南总是期待着等我的腿子好了和我一起出去玩儿～"
    ]
  },
  {
    to: "查艺",
    from: "永远爱你的自己",
    salutation: "亲爱的自己：",
    paragraphs: [
      "提笔写下这些话，想好好和你说一声谢谢。谢谢你，在跌跌撞撞的日子里从未放弃，在迷茫焦虑时依然选择咬牙坚持，在无人撑腰的时刻，始终做自己最坚实的后盾。",
      "谢谢你，接纳自己的不完美，包容那些偶尔的脆弱和笨拙，没有因为一次失意就否定全部，也没有因为旁人的声音就偏离自己的方向。你学着和生活和解，学着在风雨里撑伞，学着把委屈化作力量，一点点把日子过成自己想要的模样。",
      "往后的日子，愿你依旧勇敢、坦荡、温暖，继续做那个眼里有光、心中有海的自己。不必追光，你本身就是光；不必将就，你值得所有美好。愿你平安喜乐，万事顺意，余生皆甜。",
      "最后，再次谢谢独一无二的你，未来的路，继续好好爱自己，大步向前走。"
    ]
  },
  {
    to: "五号楼的长辈",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "在楚园的日常，总被忙碌填满，手头的事一桩接一桩，日子仿佛在脚步匆匆中悄然划过。若有人问我，这里的温暖藏在哪些具体的事里，我竟一时语塞，想不起什么轰轰烈烈的瞬间，可心底那份感动，却全是由长辈们一个个细小的举动堆积起来的。",
      "我从不是那个被忽略的忙碌者，我的辛苦，我的小细节，都被五号楼的长辈们悄悄看在眼里、记在心上。忙到饭点，总会有长辈问我“吃饭没？再忙也得按时吃饭”；下班稍晚，遇到的长辈也会问“天黑了，有车回家不？”；天冷了，也会提醒我加衣。",
      "有时就连我自己都没察觉的驼背，却逃不过他们的眼睛，经常提醒“挺直背，年轻人要挺直腰板”。像家里爷爷奶奶的叮嘱，亲切又暖心。",
      "我总以为，是我在守护着长辈们的日常，却不曾想，这份陪伴从来都是双向的奔赴。我用细心照顾他们的日常，他们便用最质朴的方式，心疼着我的忙碌。",
      "那些形容不出具体的细小举动，没有刻意的表达，却像一缕缕温柔的风，吹散了工作的疲惫，让我在这份忙碌的工作里，始终被温暖包围，始终有前行的力量！"
    ]
  },
  {
    to: "老己",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "这一年，步履不停，在工作的责任里坚守，在家庭的暖意里奔赴，也为自己的热爱留了空间。不算最好，却已拼尽全力。往后，好好爱自己，照顾好身体与心灵，我值得所有的美好。"
    ]
  },
  {
    to: "6号楼管家李子俊",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "作为楼栋团队的力量担当，感谢你一年来不厌其烦的协助大家进行搬床，搬家、登高、维修、安装等等众多的力气活，身高体重没白长哈，虽然你不善表达，也明白你内心深处的那抹细心和真诚，未来的日子希望你更加独当一面，日常在我们相互的配合下，所有的工作能够顺利完美的完成，2026我们同奋斗、共成长，我们更给力！"
    ]
  },
  {
    to: "杨万英和五号楼居民",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "杨万英和五号楼的所有居民收下这朵小红花啦！",
      "新的一岁，愿健康平安常伴，生活处处有阳光，每一天都充满欢笑与温暖～",
      "工作顺顺利利，邻里和和睦睦，日子越过越甜！"
    ]
  },
  {
    to: "贺仕光经理",
    from: "何梦瑶",
    salutation: "尊敬的贺经理：",
    paragraphs: [
      "向您表达诚挚的感谢。记得有一天主管们外出，楼栋人手不足，您百忙之中带领我们开展工作，恰逢当日事务繁杂，您有条不紊统筹安排，还耐心指导我们处理各项工作。面对突发情况，您沉着处理，在忙碌中也能理清思路、稳步推进，您的担当与悉心，让我们倍感温暖。"
    ]
  },
  {
    to: "行政前台全体伙伴",
    from: "匿名",
    salutation: "致所有可爱的伙伴们：",
    paragraphs: [
      "忙忙碌碌又一年，感恩并肩的每一位伙伴，感谢每一次并肩的默契，每一份全力以赴的担当。新岁新程，愿我们继续携手，步履不停，共创更精彩的一年！"
    ]
  },
  {
    to: "行政前台全体伙伴",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "在这里，每一句“我来”都那么自然。早高峰时，有人会顺手为忙碌的伙伴接好热线电话；面对复杂问询，总有人主动凑过来轻声补充细节。午间休息，分享小零食的窸窣声里夹着办理业务的温馨提醒。新同事第一次操作系统，周围会伸出好几只手，指向屏幕上不同按钮。",
      "我们共享着一本手写“锦囊”，记满了疑难问题的解决方案。一个眼神就能明白彼此需要支援，一句“辛苦了”就是最暖的加油。在这个小小的空间里，忙碌从未让温暖缺席。因为知道身后总有伙伴，所以每个面向客人的微笑，都格外踏实安心。",
      "我们不只是并肩工作的同事，更是让前台这个“窗口”始终明亮温暖的，一束光。"
    ]
  },
  {
    to: "李书兵总",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "猜一猜我想感谢的是谁？他会在百忙之中抽出时间关心新员工在工作岗位上的适应情况，他会在新员工困惑和苦恼时提供自己的经验和心得。",
      "他总说我们要经常保持微笑，工作状态也要积极向上，精神饱满；他也说过和长辈相处是一种持续情绪价值输出的状态，在这过程中我们有时候也会感觉到很委屈，一定要保持我们自身的心理健康。",
      "刚接触管家这个岗位时，对于有点脸盲症的我来说，每日的安全触点记忆居民很困难。他说“居民的长相是必须要记住的，你可以先把房间号和姓名背下来，在日常工作中多多接触居民，尽快对号入座”，这给了我一个大概方向。每天会拍照不认识的居民，只要熟悉了长相，就能将房号、姓名都一一对应记住。",
      "我很感谢您对我的关心和点拨，借此花语信箱的机会，衷心祝您身体健康，在新的一年里工作再创佳绩，“业绩爆表不加班”，个人生活美满幸福，笑口常开！"
    ]
  },
  {
    to: "李嘉乐、李月",
    from: "方欣",
    salutation: "",
    paragraphs: [
      "回望2025年的点点滴滴，心中满是感慨与感恩。这一年，对楚园社工团队而言，是极具挑战、充满动荡的一年——3位资深社工伙伴相继离职，曾经的社工团队全军覆没。危难之际，总有人挺身而出，而你们，就是照亮这段艰难旅程的光。",
      "2025年2月底，李嘉乐伙伴临危受命，从管家岗位被紧急调至社工岗，没有丝毫犹豫，也没有时间慢慢适应，便毅然扛起了社工工作的重任，快速衔接各项服务。6月底，李月伙伴尚是一名实习生，却也主动响应调配，加入了社工团队这个“新战场”，而她接手的，正是全园区风险最高、难度最大的3-4号楼。彼时的你们，一个是转换岗位，一个是初出茅庐的实习生，却都凭着一股韧劲，接住了这份沉甸甸的责任。",
      "困境从未停止接踵而至。10月，意外突然降临，嘉乐伙伴不幸骨折，本应安心休养、静待康复的她，深知社工人手极度紧缺，各项工作无法耽搁，在短暂休养几天后，便毅然返岗投入工作。可这终究加重了她的病情，嘉乐伙伴不得不暂停工作，回家静养。",
      "嘉乐的休养，让本就紧张的人手变得更加拮据，社工团队只剩下我和李月两人并肩作战。可之后我因工作需要，先后前往北京参加培训、拍摄青春养老人主题视频、奔赴长沙参与社工技能比赛，一段时期内，社工岗位几乎只剩下李月伙伴一人坚守。而彼时正值年底，各项工作任务扎堆而来：入住前评估、大量新居民入住后首拜访、老居民定期评估和服务方案以及高风险居民服务方案沟通书等。但李月伙伴没有退缩、没有抱怨，一个人扛起了所有工作，默默坚守、全力以赴。当然，此时也离不开管家伙伴的支援。",
      "就在我们稍稍缓过劲来时，李月伙伴又需前往蜀园参加新人实训，社工岗再次面临无人值守的困境。得知这一情况后，嘉乐伙伴不顾腿伤尚未完全痊愈，毅然选择再次返岗。那段时间，整个楚园里，总能看到她坐着辅助车、单腿滑行的身影，即便行动不便，她也从未耽误一项工作，始终坚守在自己的岗位上。",
      "我常常心怀感动与感激，我们是一个全新的团队，2位伙伴在社工岗位上的工作经验都还未满一年。面对团队指标，2位伙伴从未喊过一声辛苦，选择放弃休息，全力以赴。在社工的团队里，从来没有“你的工作”“我的工作”，只有“我们的工作”。没有推诿、没有计较，只有相互扶持、彼此包容；没有退缩、没有放弃，只有同心同德、共克时艰。",
      "我深知，这一年，我们的工作或许还有诸多不完美，还有许多需要提升的地方，但我坚信，这是一个不断进取的团队，我们的社工团队，一定能慢慢走向成熟、走向专业。感恩2025年，有你们一路相伴、并肩作战。致我最珍贵的社工伙伴——李嘉乐、李月。"
    ]
  },
  {
    to: "楚园各部门的工作人员",
    from: "匿名",
    salutation: "亲爱的楚园各部门的伙伴们：",
    paragraphs: [
      "过去的一年，我们一起经历了无数温暖的瞬间，也一起面对了不少挑战。正是因为有了各个部门的默契配合，我们才能让长辈们在楚园的每一天都安心、舒心、暖心。",
      "感谢工程与环境部的伙伴们，你们用专业和细致，把园区的每一处设施都打理得安全又整洁，这些都离不开你们的默默付出。感谢餐饮部的伙伴们，你们把对长辈的关怀带进了一日三餐里，每一口都带着温度，让长辈们吃得放心又开心。感谢安保部的伙伴们，你们是园区最坚实的“安全屏障”。无论白天黑夜，你们的巡逻和守护，让我们所有人都倍感安心。",
      "感谢销售部的伙伴们，你们用真诚的沟通，把楚园的温暖传递给了更多家庭。正是因为你们的推介，才有更多长辈选择在这里开启幸福的晚年生活。感谢医务室与康复医院的同事们，你们是长辈们健康的“守护者”。从日常的健康监测到突发状况的紧急处理，你们用专业和耐心，为长辈们的健康保驾护航。",
      "感谢活动部的伙伴们，你们是楚园里的“快乐制造机”。一场场热闹的节日庆典、一堂堂有趣的兴趣课程，还有一次次暖心的生日会，是你们用创意和热情，让长辈们的晚年生活充满欢笑与色彩。感谢行政部的伙伴们，你们是楚园高效运转的“大管家”。每一件琐碎的事你们都处理得井井有条，让我们能更安心地专注于照护服务。",
      "养老这份事业，从来不是一个人的战斗，而是一群人的奔赴。是工程的严谨、环境的细致、餐饮的用心、安保的坚守、销售的真诚、医护的专业、活动的热情，还有行政的支撑，才让楚园成为了长辈们真正的“家”。新的一年，愿我们继续携手，把温暖传递给每一位长辈，把信任交付给每一个家庭。",
      "最后，再次向每一位伙伴道一声：辛苦了，谢谢你们！"
    ]
  },
  {
    to: "五六号楼管家小伙伴",
    from: "匿名",
    salutation: "致我可爱的班搭子小伙伴：",
    paragraphs: [
      "时光流转，一年又到了尾声。不知不觉，我们已并肩走过了近三年的路。借这次年会留言的机会，有些话想对你们说——真诚的感谢你们一直以来的支持与陪伴，也真心为你们每一步的成长感到骄傲与欣喜。",
      "万英，你小小的身体里，总蕴藏着大大的能量。在你身上能看到了一种温柔的坚韧，无论是多琐碎、多棘手的事情，你都能耐心细致地完成，把居民的每一件“麻烦事”都记在心上一一处理。新的一年，希望你能更自信一点，不要怀疑自己。你本来就很棒，也值得所有的肯定。",
      "海艳，你总爱调侃自己是个“冷漠的女人”，可我总能看见你细腻柔软的内心。你能听懂长辈没说出口的话，也能体会他们背后的无奈与焦虑。你同样会为长辈担心着急，也会默默的守护在长辈每次需要的时刻。新的一年，愿你学业顺利，成为更好的自己。",
      "虹霞，你就像一颗小太阳，温暖着身边的人。很强的共情力，总是能迅速走进长辈的心里，也能拉近伙伴之间的距离。两年时间里，你始终保持着热情与善意，同样沟通协调上也突飞猛进。新的一年，愿你再勇敢一些，勇敢面对冲突，勇敢表达自己，勇敢去争取属于你的光亮。",
      "子俊，是团队里年龄最小也是唯一的男生，永远记得你最初服务时的些许紧张（长辈生病你推她到康复医院路上不自觉的“飞起”），到如今的从容妥帖，你的成长快得让人惊喜。现在你已经真正成了团队里的“力量担当”，伙伴需要帮忙时，你总是毫不犹豫伸出手，每次搬家换房，总默默把最重的拖车放在自己手里——真诚永远是“必杀技”。新的一年，愿你保持学习的劲头，继续全方位地成长，稳稳地走好每一步。",
      "怀山海热忱而不失烟火温度，持少年锐气而更添岁月温润。新年快乐，永远快乐，我的小伙伴们。"
    ]
  },
  {
    to: "成星星",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "刚入职进入办公室时，大家都在忙碌，那时我满是陌生与忐忑，你是我在办公室认识的第一个小伙伴。那天的工作很繁忙，你戴着口罩，从眼睛里透出笑意，把工牌递到我面前，轻声说：“我是成星星，可以叫我星星。”那一刻，你的笑容和热情，就悄悄卸下了我所有的拘谨与不安。",
      "后来，我不熟悉公司路线，是你带着我，把每一条常用路、每一个关键地点都一一指给我；我搞不清班车与宿舍，是你陪我一起乘车，休息时也迅速地回应我的问题，耐心教我怎么处理；工作遇到难题，我焦虑得手足无措，你一点点问清情况，把经验慢慢讲给我听，让我的慌乱一点点平复；当我被棘手的事困住，你一句“你在哪”，就立刻赶来帮我解围；在我怀疑自己时，你那句“我觉得你做得很好”，给了我莫大的底气。",
      "还记得有次我独自坐在工位上茫然无措，你走过来轻声说：“看你一个人坐着，怕你觉得慌。”然后自然地把我拉进工作的节奏里……这些细碎又温暖的瞬间，汇成了我入职初期最踏实的光。谢谢你，星星✨"
    ]
  },
  {
    to: "易红总",
    from: "吴梦君",
    salutation: "",
    paragraphs: [
      "值此岁末年初之际，我借此机会感谢社区总经理易总的鼓励和支持！",
      "在过去的两年，我自发备考社会工作师（中级）专业技术职业资格证书，以及游泳社会体育指导员职业资格证书，易总每次来游泳的时候，看到我在复习备考，都会热情地鼓励我。我第一次没有全部考过，易总还鼓励我说考不过也没关系，增加知识和经验也是很不错的。",
      "我考过之后，易总在多个场合表扬我努力考证的行动，让我很感动，感觉到了许多理解和支持，更有动力了。"
    ]
  },
  {
    to: "肖虹霞",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "旧年翻篇，新岁启章！",
      "在过去的一年里，恰逢也是自己的本命年，想想也突破了一些以前不曾想的事情，比如第一次主持楼层活动，第一次勇敢举手发言得积分获得优秀学员称号，第一次带长辈做游戏，第一次协助拍视频，第一次上台表演跳舞等等，让我发现其实迈出那一步没有那么难，谢谢一直在努力找到更好的自己。",
      "在日复一日的工作中，在每天大大小小的事务中，有过崩溃，有过担心，有过害怕，但是从没有过退缩和放弃，内心深处那份热爱依然让自己坚持了下去，你总是嫌弃自己不够坚强，可是每次也都是擦干眼泪，勇敢向前，你真的很棒，谢谢那个一直以来不服输、不退缩的自己。",
      "新的一年，希望自己更加努力工作，挑战更多的未知事物，永远为自己是青春养老人而骄傲，大声告诉自己细水长流也可以～爱你老己～"
    ]
  },
  {
    to: "朱思斯",
    from: "匿名",
    salutation: "亲爱的思斯经理：",
    paragraphs: [
      "当看到“花语信箱”的征集令时，我几乎是立刻就决定要写给您。虽然也想对自己说一句“感谢老己”，也有很多其他想要感谢的人，但此刻，所有情绪都抵不过想对您说的话。",
      "我一毕业就扎进了楚园的烟火里，就是您带着我，算到今天（2026 年 1 月 26 日），已经在泰康走过了 2 年 204 天。没毕业前，我总以为“经理”是个高高在上的职位，可直到遇见您，才明白真正的带领是并肩同行。",
      "我还记得第一次组织活动时手忙脚乱，是您在我身边，陪着我核对流程、反复敲定细节；第一次被长辈误解委屈掉眼泪时，是您轻声说“没关系，我们一起面对”；更记得无数次在活动现场，您陪着我们一起整理活动物料布置现场，您卷起袖子和我们一起搬桌子、摆椅子，额角的汗和我们混在一起。那一刻我才懂，您从来不是站在我们身后的领导，而是和我们在同一战线的伙伴。",
      "这一路，我从 2023 年的 8 月份月度优秀员工、2023 年的 11 月份月度优秀员工、2023 年度通讯支持奖，走到 2024 年的泰康之家年度优秀千人，再到 2025 年的楚园优秀员工（虽然还没有出结果，但是在我心里，您举荐了我，我觉得这就足够了）。我看着自己一点点变稳、变强，心里比谁都清楚：如果没有您一次次在我卡壳时耐心拆解问题，在我犹豫时给我“去做就好”的底气，在我取得一点成绩时毫不吝啬的肯定，我走不到今天。",
      "您总笑着说，自己是“带着一群大朋友，照顾一群老朋友”。可我们都知道，您也只是个会焦虑、会脆弱的女孩子。我们见过您为了长辈的一个紧急需求，在寒风里跑着协调资源；见过您为了一场活动的细节，对着方案反复修调整；也见过您因为外界的一句评价微微沮丧，却又很快整理好情绪，转头就笑着来鼓励我们。",
      "您总把我们护在身后，却忘了自己也需要被温柔对待。新的一年，我们希望您：少熬一点夜，多睡一个安稳的懒觉；少纠结一点外界的声音，多听听自己内心的节奏；少扛一点压力，偶尔也可以依赖我们一次。",
      "对我们而言，您从来都不只是领导。您是在我们手足无措时，会停下来和我一起找办法的大姐姐；是在我们迷茫时，会点醒我们“你比自己想象的更厉害”的引路人；更是在我们累到想放弃时，会拍拍我们肩膀说“再走一步就好”的同行者。",
      "最后想认真对您说：亲爱的思斯经理，您辛苦了！新的一年，我们会继续跟着您好好干，也祝您能卸下一些疲惫，活得更松弛、更开心。我们也会好好努力，也会慢慢长成能为您分担的人。"
    ]
  },
  {
    to: "员工餐饮团队",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "我是一个挑剔鬼，2024 年极少在社区吃晚饭；2025 年，我上班日几乎三餐都在公司吃。",
      "员工餐相比之前真是出现了翻天覆地的变化，时不时能给我们带来些小惊喜。吃着这么美味的员工餐，我觉得楚园发展真是欣欣向荣！！！"
    ]
  },
  {
    to: "黄海艳",
    from: "匿名",
    salutation: "致黄海艳",
    paragraphs: [
      "工作路上最幸运的莫过于遇见合拍的你，不用多言的默契，遇事互相兜底的安心，再繁琐的工作一起扛，再棘手的问题一起解，共事的每一天都踏实又舒心。感恩一路相伴、彼此照应，愿我们往后依旧并肩作战，工作顺风顺水，事事皆得所愿，一直做彼此最靠谱的工作搭子～"
    ]
  },
  {
    to: "运维团队",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "2025 年，运维团队的销量更高啦，和服务团队的配合更加默契啦！",
      "那天我去长辈家里入户拜访，进门后发现长辈家里的门关不严、疑似金属合页坏了，于是下了工单。十几分钟后我从长辈家出来，师傅已经到房门口了，三分钟功夫就把门修好了，奈斯！！！为运维团队点赞！"
    ]
  },
  {
    to: "方欣姐，嘉乐，梦丽姐，睿洁，熙雅",
    from: "匿名",
    salutation: "致社工小伙伴：",
    paragraphs: [
      "躺在床上，回忆起到社工岗之后的时光，一路走来，很感谢有她们。",
      "“这个月的应急演练什么时候？”“明天有新居民评估”“Xx长辈跌倒了，要查监控”“服务方案任务覆盖看一下”，社工的工作内容很明确，又十分考验一心多用的能力。",
      "刚来的一个月，梦丽姐说“做好一个月迅速成长的准备”，当时真的觉得压力很大。但她非常细致、有规划地带我熟悉社工业务，虽然有时候觉得她很严厉，但转念想想，这么优秀的前辈不遗余力地指导我工作，多幸运啊。印象最深的是她跟我交接重点关注居民，她能对着居民列表清楚地说出每位长辈的身体情况、家庭情况和禁忌，这是她宝贵的经验，也是她对长辈用心的体现，这也成了我后来奋斗的目标。",
      "后来欣姐调回社工岗，真的觉得有了强大的支撑。欣姐很直爽，有时候也很可爱，喜欢和我们分享零食，每次我都会悄悄拿出手机搜索同款零食，真的很好吃！她也像万事通，而我感觉自己像“十万个为什么”，总是请教欣姐业务问题。比如我刚开始对风险告知书、知情同意书的撰写不是很熟练，这时候她就会说“你写好了我来帮你修改，我很有经验哈哈哈”，我就会给到崇拜的眼神，看着修改后的材料“偷偷”学习怎么表达；我有时候暗自琢磨一些事情，有一次在晚上九十点钟我私信她人际沟通方面的问题，她很敏锐地察觉到我情绪不对，她的关心和开导让我不再内耗，当时的反应和表情包“你知道的我离不开你”一模一样。",
      "嘉乐也是百事通一样的存在！在我心里，她很聪明，总是和我分享在楚园工作的 tips，比如打印机的使用、看板的查找、oa 流程，很多个第一次是她教会我的。她也是安全员，会在初雪过后提醒我不要骑电驴通勤。还记得有次我们一起从大悦城回来，她提示我走在大楼屋檐里面，防止高空坠物；我还想感谢她送我的挡风披，陪伴我上下班，每当寒夜骑车时，会更添一份温暖。她也像心理委员，在我“不得劲”的时候举例安慰我，让我学会辩证看待一些话语，能够及时调适自我。",
      "睿洁是我们的得力伙伴！刚开始以为她是很内敛的女生，没想到一口答应帮我一起拍防跌课程视频，她饰演阿姨的样子很大方，最后我们剪辑出来的视频也很有效果。工作中她很负责，我们也很安心。在 11 月特别忙的时候，幸亏有她一起，我们顺利扛住了工作量。",
      "熙雅小伙伴刚来不久，很沉稳，平时我们交流工作内容偏多。今天她分享了家里做的牛肉丝，还没来得及拆开哈哈，大早上的心里暖暖的，期待和她合作更多，相互之间增进了解。",
      "没有华丽的文采，但我很感激有这样一群善良、阳光的伙伴共事，让我有我们是一个 team 的感受。我们是战友，是彼此最信赖的伙伴。感恩有你们🤗"
    ]
  },
  {
    to: "马默君",
    from: "匿名",
    salutation: "致马阿姨的感谢信",
    paragraphs: [
      "亲爱的马阿姨：龙马精神，感恩有您！在泰康之家楚园，您是温暖与活力的象征。",
      "作为掼蛋俱乐部负责人，日常活动里您处处用心，帮助成员学习和成长。新居民不会玩掼蛋，您耐心教学，从规则到技巧，细致讲解，让新手迅速入门，俱乐部氛围越来越好。",
      "掼蛋比赛中，您化身义工居民，全力服务。为选手加油鼓劲，还及时解答选手对规则的疑问，让比赛紧张又有趣。",
      "您还关心成员需求，主动交流，为大家排忧解难，让俱乐部成为交流感情、增进友谊的桥梁。",
      "马阿姨，您的付出温暖了大家。新的一年，祝您身体健康、快乐幸福！衷心感谢您！"
    ]
  },
  {
    to: "田苗苗",
    from: "雷创创",
    salutation: "",
    paragraphs: [
      "记得刚入职第一天，自我介绍后你就迫不及待的问：“你会做手工吗？喜欢植物吗？”我回答喜欢后你给我了一颗薄荷糖，没想到羁绊就悄悄产生。",
      "后来我成为了你的小尾巴，你带着我一起首拜访、一起做园艺、一起做手工。最深刻的是带着我一户一户的介绍园艺疗愈，这份热情认真的精神也影响着我后来的工作。",
      "记得最开始园艺课我分不清工具，你把铲子递过来时顺手调整了我的握姿：“虎口抵这儿，省力。”菜园整理后，你拉着我拍照，说：“这可是你第一次整理菜园，可要好好纪念！”",
      "慢慢地，我能独自带园艺疗愈课了，能在端午重阳等活动上从容地调度各个环节。但每次重要活动前，你还是会发来消息：“物料清单我多印了一份放前台”，或者“记得提醒欧阳阿姨准时参加”。",
      "后来又有新的园艺疗愈师需要认证，我带教结束后你说：“下个学期的园艺疗愈你负责，我来协助。”出门时阳光正好，把你的影子拉得很长。",
      "那颗薄荷糖后来被我种在办公桌的小花盆里，居然发了芽。每天看见那抹绿，就会想起有人从一开始，就把我当成可以并肩的伙伴。谢谢你，我的小太阳。"
    ]
  },
  {
    to: "杜双琪主管 胡佩主管",
    from: "匿名",
    salutation: "",
    paragraphs: [
      "“星星、姗姗、霞霞、宝……”——这些特别的称呼，是我来到办公室后听到的第一声问候，这些亲切的称呼瞬间消融了我初来时的紧张与不安。那一句“有问题随时问”，更成了我融入这里最初的信赖与依靠。你们在忙碌中仍会见缝插针地教授我工作中新的内容，从安全触点到入户访视，从流程讲解到细节叮嘱，你们不厌其烦地教授我流程与技巧，这些让我在面对新工作时，逐渐有了放开手脚的底气。特别记得站在双琪主管身旁时，她总是耐心地讲解每一个步骤，还会伸手轻轻帮我整理耳边的碎发，就这样自然的动作，让我记了好久，现在想起依旧会觉得温暖，充满了被关照的踏实。胡佩主管则像是一颗定心丸，总在我们需要时适时出现，用她轻快的分享化解紧张。“不慌”“吃饭了吗”“路上注意安全”……这些简单的话语从她口中说出，总能带来一股安稳的力量，让我们在服务长辈的过程中也想起来关爱自己。在这里，我学到的不仅是工作的技能，更是一份人与人之间真诚相待的温度，一种踏实做事、温暖为人的态度。未来，我也会在服务长辈的日常中，持续践行这份人文关怀，这里流淌的不仅是专业的照护，更是员工与长辈之间，员工之间温暖的双向奔赴～！"
    ]
  }
];

// 通用模板信（用于前 15 封之后的信件）
const TEMPLATE_LETTER = {
  to: "",
  from: "匿名",
  salutation: "亲爱的伙伴们：",
  paragraphs: [
    "如果用一种颜色形容我们这个大家庭，我想是暖红色——像一朵小红花那样，不夺目却温暖，不张扬却坚韧。在此，我想为你们每个人都别上一朵。",
    "致我敬爱的领导：谢谢您在我们迷茫时点亮灯塔，在我们冲刺时拓宽跑道。您给予的不仅是方向，更是敢于试错的底气。这朵小红花，献给您的远见与担当。",
    "致管家部的织梦人：是你们把散落的星光串成银河，让服务讲述温度。这朵小红花，献给你们连接万物的细腻与执着。",
    "致营销部的探险家：你们在喧嚣中捕捉回声，在未知处开拓疆土。感谢你们让好故事被听见。这朵小红花，献给每一次勇敢的“走出去”。",
    "致运营保障的守护者：制度有了温度，琐碎化为有序。你们是让舞台稳固的基石。这朵小红花，献给默默托举的每一天。",
    "致后台行政部门的春风拂面者：你们是日常里无声的润泽——有序的流程、温暖的物资、明亮的空间、妥帖的关怀，让奔波有了港湾，让琐碎化为安心。这朵小红花，献给你们春风化雨般的陪伴与支撑。",
    "致医疗部的健康护航者：你们用专业知识筑起安心的屏障，用细致关怀守护每一份安康。每次咨询时的耐心解答，每份健康提醒背后的用心，都让长辈更踏实、更温暖。这朵小红花，献给你们始终如一的专业与守护。",
    "每一份专注都值得被看见，每一次配合都谱成乐章。愿这朵虚拟的小红花，化作真实的暖意——谢谢你，谢谢你在这里。当我们把各自的小红花别在一起，便是这个冬天最美的春天。"
  ]
};

// ✅ 抽取逻辑改为「随机不放回」：
// 1) 你在 CUSTOM_LETTERS 里塞多少封，就先随机抽多少封（不重复）
// 2) 全部抽完后，才会开始抽「预设模板信」(TEMPLATE_LETTER)
// 3) 花朵光点数量保持固定，不与信件数量绑定
const LETTER_COUNT = CUSTOM_LETTERS.length;

// 自定义信件池：存放还没抽到的索引
let customPool = [];
let customDrawn = 0;
let templateDrawn = 0;

// 当前正在展示的信件对象
let currentLetter = null;

// 洗牌（Fisher–Yates）
function shuffleInPlace(arr){
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

// 重置抽签池（让「随机不放回」重新开始）
function resetLetterPool(){
  customPool = Array.from({length: LETTER_COUNT}, (_, i) => i);
  shuffleInPlace(customPool);
  customDrawn = 0;
  templateDrawn = 0;
  currentLetter = null;
}
resetLetterPool();


/* ========= Canvas ========= */
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d', { alpha: true });

const mainBtn = document.getElementById('mainBtn');
const bgm = document.getElementById('bgm'); // 获取 audio 元素
const musicToggleBtn = document.getElementById('musicToggleBtn'); // 获取音乐控制按钮
let isPlaying = false;

// 初始设置音量
if(bgm) bgm.volume = 0.3; // 设置默认音量，避免太响

// 页面加载完成后尝试自动播放
document.addEventListener('DOMContentLoaded', () => {
  if (bgm) {
    bgm.play().then(() => {
      console.log('背景音乐自动播放成功。');
      isPlaying = true;
      musicToggleBtn.textContent = '| |'; // 播放图标
    }).catch(e => {
      console.log('背景音乐自动播放失败（可能被浏览器阻止）。' + e);
      isPlaying = false;
      musicToggleBtn.textContent = '▶'; // 暂停图标
    });
  }
});

// 音乐控制按钮点击事件
musicToggleBtn.addEventListener('click', () => {
  if (!bgm) return;

  if (isPlaying) {
    bgm.pause();
    isPlaying = false;
    musicToggleBtn.textContent = '▶'; // 暂停图标
  } else {
    bgm.play().then(() => {
      isPlaying = true;
      musicToggleBtn.textContent = '| |'; // 播放图标
    }).catch(e => {
      console.log('背景音乐手动播放失败。' + e);
      isPlaying = false;
      musicToggleBtn.textContent = '▶'; // 暂停图标
    });
  }
});
const paper = document.getElementById('paper');
const paperBody = document.getElementById('paperBody');
const paperHead = document.getElementById('paperHead');
const paperHint = document.getElementById('paperHint');

let W=0,H=0,DPR=1;
function resize(){
  DPR = Math.min(2, window.devicePixelRatio || 1);
  W = canvas.width = Math.floor(innerWidth * DPR);
  H = canvas.height = Math.floor(innerHeight * DPR);
  canvas.style.width = innerWidth + "px";
  canvas.style.height = innerHeight + "px";
}
addEventListener('resize', resize, {passive:true});
resize();

/* ========= Helpers ========= */
const palette = {
  champ: [246,230,194],
  gold:  [232,197,106],
  // ✅ 与整体色调统一：低饱和珊瑚/桃
  coral: [255,154,179],
  peach: [255,214,198],
  mint:  [207,239,217],
  sky:   [191,216,255]
};
const bulletColors = ["champ","coral","peach","mint","sky"];
function rgba([r,g,b], a){ return `rgba(${r},${g},${b},${a})`; }
function lerp(a,b,t){ return a+(b-a)*t; }
function clamp(x,a,b){ return Math.max(a, Math.min(b,x)); }
function easeOutCubic(t){ return 1 - Math.pow(1-t,3); }
function easeInOutCubic(t){ return t<0.5 ? 4*t*t*t : 1 - Math.pow(-2*t+2,3)/2; }

/* ========= Parallax ========= */
let px = 0, py = 0;
addEventListener('pointermove', (e)=>{
  px = (e.clientX / innerWidth) * 2 - 1;
  py = (e.clientY / innerHeight) * 2 - 1;
}, {passive:true});

/* ========= Scene ========= */
// 光点固定数量（花朵），与信件总数解耦
const usedFlowers = new Set();
const usedAt = new Map();

// 信件抽取状态：优先抽完自定义信件池，再进入模板信
const remainingCustom = () => customPool.length;

// 背景墙上的“弹幕”留言
// 适当增加轨道数量，并控制同一轨道内的间距，避免文字互相遮挡
const bulletLanes = 8;
const bullets = [];

function spawnBullet(msgIndex, initial){
  const text = SELF_MESSAGES[msgIndex];
  const lane = Math.floor(Math.random() * bulletLanes);
  const size = lerp(16, 26, Math.random()); // 字号
  const alpha = lerp(0.22, 0.40, Math.random());
  // 略微提升整体滑动速度（视觉上更像“轻快弹幕”）
  const speed = lerp(0.06, 0.12, Math.random()); // px/ms
  const colorKey = bulletColors[Math.floor(Math.random() * bulletColors.length)];

  // 计算宽度用于回收判断
  ctx.save();
  ctx.font = `${size * (window.devicePixelRatio || 1)}px "Noto Serif SC","Songti SC","STSong","Microsoft YaHei",system-ui`;
  const width = ctx.measureText(text).width;
  ctx.restore();

  const baseY = 0.20 * H;
  const laneGap = (0.60 * H) / Math.max(1, bulletLanes - 1);
  const y = baseY + lane * laneGap;

  // 避免同一轨道上的新弹幕“追尾”上一条：保证有一定间距再出现
  let lastRight = -Infinity;
  for(const b of bullets){
    if(b.lane === lane){
      lastRight = Math.max(lastRight, b.x + b.width);
    }
  }
  const baseStart = W + 40;
  const gap = 80;
  const startX = lastRight > -Infinity ? Math.max(baseStart, lastRight + gap) : baseStart;

  bullets.push({
    text,
    msgIndex,
    lane,
    x: startX,
    y,
    size,
    alpha,
    speed,
    colorKey,
    width
  });
}

function initBullets(){
  for(let i=0;i<SELF_MESSAGES.length;i++){
    spawnBullet(i, true);
  }
}

const SPHERE = {
  rotY: 0,
  rotX: -0.22,
  baseSpeed: 0.00130,
  spinSpeed: 0.010,
  curSpeed: 0.00130,
  tiltX: 0,
  tiltY: 0
};

let mode = "idle";
let slowStart = 0, slowDur = 2000, slowFrom = 0, slowTo = 0;
let chosenIndex = -1, highlightT = 0, revealT = 0;
let pulseStart = -1;

/* Dot globe points */
const globeDots = [];
(function buildDots(){
  const latSteps = 14, lonSteps = 28;
  for(let i=0;i<=latSteps;i++){
    const v = i/latSteps;
    const lat = lerp(-Math.PI/2, Math.PI/2, v);
    const cos = Math.cos(lat), sin = Math.sin(lat);
    for(let j=0;j<lonSteps;j++){
      const u = j/lonSteps;
      const lon = u*Math.PI*2;
      globeDots.push({
        x: cos*Math.cos(lon),
        y: sin,
        z: cos*Math.sin(lon),
        seed: Math.random(),
        tint: Math.random()<0.6 ? "champ" : (Math.random()<0.55 ? "mint":"sky")
      });
    }
  }
})();

/* Flowers on sphere */
const flowers = [];
(function buildFlowers(){
  const n = 70; // 固定 70 个光点
  const golden = Math.PI * (3 - Math.sqrt(5));
  for(let i=0;i<n;i++){
    const y = 1 - (i/(n-1))*2;
    const r = Math.sqrt(1 - y*y);
    const theta = golden * i;
    flowers.push({
      x: Math.cos(theta)*r,
      y,
      z: Math.sin(theta)*r,
      tw: Math.random()*Math.PI*2,
      hue: Math.random()<0.72 ? "coral" : "peach"
    });
  }
})();

/* Background dust */
const particles = [];
(function buildParticles(){
  const count = 130;
  for(let i=0;i<count;i++){
    particles.push({
      x: Math.random(),
      y: Math.random(),
      s: lerp(0.5, 1.8, Math.random()),
      a: lerp(0.05, 0.17, Math.random()),
      drift: lerp(0.00002, 0.000095, Math.random()),
      tint: Math.random() < 0.7 ? "champ" : (Math.random()<0.5 ? "mint":"sky")
    });
  }
})();

/* Rotation & projection */
function rotY(p, a){
  const c=Math.cos(a), s=Math.sin(a);
  return { x: p.x*c + p.z*s, y: p.y, z: -p.x*s + p.z*c };
}
function rotX(p, a){
  const c=Math.cos(a), s=Math.sin(a);
  return { x: p.x, y: p.y*c - p.z*s, z: p.y*s + p.z*c };
}
function project(p, cx, cy, size){
  const z = p.z + 2.45;
  const k = 1 / z;
  return { x: cx + p.x * size * k, y: cy + p.y * size * k, k, z };
}

/* Letter UI */
function escapeHtml(s){
  return String(s ?? "")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#39;");
}
function showPaper(item){
  paperHead.textContent = "感 谢 信";
  paperHint.textContent = "（花语信箱 · 致敬时刻）";
  const ps = Array.isArray(item.paragraphs) ? item.paragraphs : [];
  const salutation = (item.salutation || "").trim();
  const to = (item.to || "").trim();
  const from = (item.from || "").trim();

  const parts = [];
  parts.push(`<div class="letterContent">`);
  if(salutation){
    parts.push(`<p class="salutation">${escapeHtml(salutation)}</p>`);
  }
  for(const p of ps){
    const t = String(p ?? "").trim();
    if(!t) continue;
    parts.push(`<p>${escapeHtml(t)}</p>`);
  }
  parts.push(`<div class="letterEnd">`);
  if(to){
    parts.push(`<div class="letterTo">送给【${escapeHtml(to)}】</div>`);
  }
  if(from){
    parts.push(`<div class="letterFrom">——${escapeHtml(from)}</div>`);
  }
  parts.push(`</div>`);
  parts.push(`</div>`);
  paperBody.innerHTML = parts.join("");
  paper.classList.add('show');
  paper.setAttribute('aria-hidden','false');
}
function hidePaper(){
  paper.classList.remove('show');
  paper.setAttribute('aria-hidden','true');
}
hidePaper();

/* Pick */
function pickFlowerBySpotlight(cx, cy, radiusPx){
  let best = -1, bestScore = Infinity;
  const sx = cx, sy = cy - radiusPx*0.62;

  for(let i=0;i<flowers.length;i++){
    // 在还没用完 70 朵花之前，避免重复命中同一朵
    if(usedFlowers.size < flowers.length && usedFlowers.has(i)) continue;
    let p = rotY(flowers[i], SPHERE.rotY);
    p = rotX(p, SPHERE.rotX);
    if(p.z < -0.16) continue;

    const pr = project(p, cx, cy, radiusPx);
    const dx = pr.x - sx, dy = pr.y - sy;
    const dist = Math.sqrt(dx*dx + dy*dy);
    const score = dist / (pr.k*1.25);
    if(score < bestScore){ bestScore = score; best = i; }
  }
  return best;
}

/* Nudge chosen */
function nudgeChosenToFront(idx){
  if(idx < 0) return;
  const offsets = [-0.35,-0.28,-0.22,-0.16,-0.10,-0.06,0,0.06,0.10,0.16,0.22,0.28,0.35];
  let bestOff = 0, bestZ = -Infinity;
  for(const off of offsets){
    let p = rotY(flowers[idx], SPHERE.rotY + off);
    p = rotX(p, SPHERE.rotX);
    if(p.z > bestZ){ bestZ = p.z; bestOff = off; }
  }
  SPHERE.rotY += bestOff;
}

/* Controls */
mainBtn.addEventListener('click', ()=>{
  // ✅ 不再在“自定义信件抽完”时强制重置；抽完后会自动进入模板信
  if(false){
    usedFlowers.clear(); usedAt.clear();
    resetLetterPool();
    chosenIndex = -1; revealT = 0;
    hidePaper();
    mode = "idle";
    SPHERE.curSpeed = SPHERE.baseSpeed;
    mainBtn.textContent = "开 始";
    pulseStart = -1;
    return;
  }
  if(mode === "idle"){
    hidePaper();
    mode = "spin";
    SPHERE.curSpeed = SPHERE.spinSpeed;
    mainBtn.textContent = "停 下";
    return;
  }
  if(mode === "spin"){
    mode = "slow";
    slowStart = performance.now();
    slowDur = 1850 + Math.random()*550;
    slowFrom = SPHERE.curSpeed;
    slowTo = SPHERE.baseSpeed * 0.22;
    mainBtn.disabled = true;
    return;
  }
  if(mode === "reveal"){
    hidePaper();
    chosenIndex = -1; highlightT = 0; revealT = 0;
    mode = "idle";
    SPHERE.curSpeed = SPHERE.baseSpeed;
    mainBtn.textContent = "开 始";
    pulseStart = -1;
  }
});
addEventListener('keydown', (e)=>{
  if(e.code === "Space"){ e.preventDefault(); mainBtn.click(); }
  // ✅ 按 R 可随时重置“随机池”（重新开始抽自定义信件）
  if(e.key === "r" || e.key === "R"){
    resetLetterPool();
    usedFlowers.clear(); usedAt.clear();
    chosenIndex = -1; revealT = 0;
    hidePaper();
    mode = "idle";
    SPHERE.curSpeed = SPHERE.baseSpeed;
    mainBtn.disabled = false;
    mainBtn.textContent = "开 始";
    pulseStart = -1;
  }
});

/* ====== Flower (保持你满意的手绘花) ====== */
function drawPetal(cx, cy, r, ang, color, alpha){
  const x1 = cx + Math.cos(ang) * (r*0.20);
  const y1 = cy + Math.sin(ang) * (r*0.20);
  const x2 = cx + Math.cos(ang) * (r*1.05);
  const y2 = cy + Math.sin(ang) * (r*1.05);
  const ort = ang + Math.PI/2;
  const w = r*0.42;

  const c1x = cx + Math.cos(ang) * (r*0.60) + Math.cos(ort)*w;
  const c1y = cy + Math.sin(ang) * (r*0.60) + Math.sin(ort)*w;
  const c2x = cx + Math.cos(ang) * (r*0.92) + Math.cos(ort)*w*0.35;
  const c2y = cy + Math.sin(ang) * (r*0.92) + Math.sin(ort)*w*0.35;

  const c3x = cx + Math.cos(ang) * (r*0.92) - Math.cos(ort)*w*0.35;
  const c3y = cy + Math.sin(ang) * (r*0.92) - Math.sin(ort)*w*0.35;
  const c4x = cx + Math.cos(ang) * (r*0.60) - Math.cos(ort)*w;
  const c4y = cy + Math.sin(ang) * (r*0.60) - Math.sin(ort)*w;

  ctx.save();
  ctx.globalAlpha = alpha;
  ctx.beginPath();
  ctx.moveTo(x1, y1);
  ctx.bezierCurveTo(c1x, c1y, c2x, c2y, x2, y2);
  ctx.bezierCurveTo(c3x, c3y, c4x, c4y, x1, y1);
  ctx.closePath();

  const g = ctx.createRadialGradient(cx - r*0.2, cy - r*0.2, r*0.2, cx, cy, r*1.4);
  g.addColorStop(0, rgba(palette[color], 0.92));
  g.addColorStop(1, rgba(palette.peach, 0.35));
  ctx.fillStyle = g;
  ctx.fill();

  ctx.strokeStyle = `rgba(15,20,28,0.18)`;
  ctx.lineWidth = 1.2*DPR;
  ctx.stroke();
  ctx.translate(0.8*DPR, 0.6*DPR);
  ctx.strokeStyle = `rgba(15,20,28,0.10)`;
  ctx.lineWidth = 1.0*DPR;
  ctx.stroke();
  ctx.restore();
}
function drawFlower(x, y, size, petalColor, alpha, isUsed, highlight){
  ctx.save();
  ctx.globalAlpha = alpha;

  const glowR = size*2.0;
  const gg = ctx.createRadialGradient(x,y,0,x,y,glowR);
  gg.addColorStop(0, `rgba(246,230,194,${0.16})`);
  gg.addColorStop(0.45, `rgba(207,239,217,${highlight?0.08:0.05})`);
  gg.addColorStop(1, `rgba(246,230,194,0)`);
  ctx.fillStyle = gg;
  ctx.beginPath();
  ctx.arc(x,y,glowR,0,Math.PI*2);
  ctx.fill();

  const petals = 6;
  const baseAng = performance.now()*0.00010;
  for(let i=0;i<petals;i++){
    const ang = baseAng + i*(Math.PI*2/petals);
    drawPetal(x,y,size*0.85,ang, petalColor, isUsed ? alpha*0.65 : alpha);
  }

  const cg = ctx.createRadialGradient(x - size*0.12, y - size*0.12, size*0.10, x, y, size*0.70);
  cg.addColorStop(0, `rgba(255,245,200,${0.95*alpha})`);
  cg.addColorStop(0.6, `rgba(246,196,90,${0.92*alpha})`);
  cg.addColorStop(1, `rgba(230,163,44,${0.90*alpha})`);
  ctx.fillStyle = cg;
  ctx.beginPath();
  ctx.arc(x,y,size*0.44,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle = `rgba(255,255,255,${0.55*alpha})`;
  ctx.beginPath();
  ctx.arc(x - size*0.12, y - size*0.12, size*0.10, 0, Math.PI*2);
  ctx.fill();

  if(isUsed){
    ctx.globalAlpha = alpha*0.65;
    ctx.fillStyle = `rgba(232,197,106,0.30)`;
    ctx.beginPath();
    ctx.arc(x,y,size*0.12,0,Math.PI*2);
    ctx.fill();
  }
  ctx.restore();
}

/* ========= Render ========= */
let last = performance.now();
function draw(now){
  const dt = Math.min(40, now-last); last = now;

  ctx.setTransform(1,0,0,1,0,0);
  ctx.clearRect(0,0,W,H);

  const cx = W*0.5;
  const cy = H*0.54;
  const R  = Math.min(W,H) * 0.45;

  // particles
  for(const p of particles){
    p.y += p.drift * dt;
    if(p.y > 1.06) p.y = -0.06;
    const col = palette[p.tint];
    ctx.beginPath();
    ctx.fillStyle = rgba(col, p.a);
    ctx.arc(p.x*W, p.y*H, p.s*DPR, 0, Math.PI*2);
    ctx.fill();
  }

  // soft bullets on background wall (behind globe/flowers)
  if(bullets.length === 0){
    initBullets();
  }else{
    // 更新位置
    for(const b of bullets){
      b.x -= b.speed * dt;
    }
    // 回收并重新生成，保持循环
    for(let i=bullets.length-1;i>=0;i--){
      const b = bullets[i];
      if(b.x + b.width < -80){
        const msgIndex = b.msgIndex;
        bullets.splice(i,1);
        spawnBullet(msgIndex, false);
      }
    }
  }

  // 绘制弹幕
  ctx.textBaseline = "middle";
  for(const b of bullets){
    const col = palette[b.colorKey];
    ctx.save();
    ctx.globalAlpha = b.alpha;
    ctx.font = `${b.size}px "Kaiti SC","STKaiti","KaiTi","Microsoft YaHei",system-ui`;
    ctx.fillStyle = rgba(col, 1);
    ctx.fillText(b.text, b.x, b.y);
    ctx.restore();
  }

  // parallax
  SPHERE.tiltY = lerp(SPHERE.tiltY, px*0.20, 0.05);
  SPHERE.tiltX = lerp(SPHERE.tiltX, py*0.12, 0.05);

  // rotation update
  if(mode==="idle" || mode==="spin"){
    SPHERE.rotY += SPHERE.curSpeed * dt;
  }else if(mode==="slow"){
    const t = clamp((now - slowStart)/slowDur, 0, 1);
    const eased = easeOutCubic(t);
    SPHERE.curSpeed = lerp(slowFrom, slowTo, eased);
    SPHERE.rotY += SPHERE.curSpeed * dt;

    if(t >= 1){
      chosenIndex = pickFlowerBySpotlight(cx, cy, R);
      if(chosenIndex < 0){
        for(let i=0;i<flowers.length;i++){
          if(!usedFlowers.has(i) || usedFlowers.size >= flowers.length){
            chosenIndex = i;
            break;
          }
        }
      }
      nudgeChosenToFront(chosenIndex);

      usedFlowers.add(chosenIndex);
      usedAt.set(chosenIndex, now);

      // ✅ 决定当前展示的信件：
// - 先从 customPool 随机不放回抽取（你塞入多少封就先抽多少封）
// - 自定义信件抽完后，才开始抽模板信
if(remainingCustom() > 0){
  const pick = customPool.pop(); // 已经被 shuffle 过，所以 pop 就是“随机”
  currentLetter = CUSTOM_LETTERS[pick];
  customDrawn++;
}else{
  currentLetter = TEMPLATE_LETTER;
  templateDrawn++;
}

      mode = "highlight";
      highlightT = 0;
      mainBtn.disabled = false;
      mainBtn.textContent = "下 一 封";
      pulseStart = now;
    }
  }else if(mode==="highlight"){
    highlightT = clamp(highlightT + dt/500, 0, 1);
    if(highlightT >= 1){
      mode = "reveal";
      revealT = 0;
    }
  }else if(mode==="reveal"){
    SPHERE.curSpeed = lerp(SPHERE.curSpeed, SPHERE.baseSpeed*0.35, 0.02);
    SPHERE.rotY += SPHERE.curSpeed * dt;
    revealT = clamp(revealT + dt/1000, 0, 1);
  }

  // globe dots
  const dotDraw = [];
  for(const d of globeDots){
    let p = rotY(d, SPHERE.rotY*0.65 + SPHERE.tiltY);
    p = rotX(p, SPHERE.rotX + SPHERE.tiltX);
    const pr = project(p, cx, cy, R);
    const a = clamp((pr.k - 0.25) * 0.45, 0, 0.16);
    dotDraw.push({x:pr.x,y:pr.y,k:pr.k,z:pr.z,a, seed:d.seed, tint:d.tint});
  }
  dotDraw.sort((a,b)=> a.z - b.z);
  for(const d of dotDraw){
    const tw = 0.78 + 0.22*Math.sin((now*0.001) + d.seed*10);
    const col = palette[d.tint];
    ctx.fillStyle = `rgba(${col[0]},${col[1]},${col[2]},${d.a*tw})`;
    ctx.beginPath();
    ctx.arc(d.x, d.y, (1.0*d.k + 0.18)*DPR, 0, Math.PI*2);
    ctx.fill();
  }

  // flowers
  const flowerDraw = [];
  for(let i=0;i<flowers.length;i++){
    let p = rotY(flowers[i], SPHERE.rotY + SPHERE.tiltY);
    p = rotX(p, SPHERE.rotX + SPHERE.tiltX);

    if(i === chosenIndex){
      if(mode === "highlight"){
        const t = easeOutCubic(highlightT);
        p.z += 0.28 * t;
        p.x = lerp(p.x, 0, 0.18*t);
        p.y = lerp(p.y, -0.02, 0.18*t);
      }else if(mode === "reveal"){
        const t = easeInOutCubic(revealT);
        p.z += lerp(0.28, 0.58, t);
        p.x = lerp(p.x, 0, lerp(0.18, 0.42, t));
        p.y = lerp(p.y, -0.02, lerp(0.18, 0.42, t));
      }
    }
    const pr = project(p, cx, cy, R);
    const front = p.z > -0.10;
    flowerDraw.push({i,x:pr.x,y:pr.y,k:pr.k,z:pr.z,front});
  }
  flowerDraw.sort((a,b)=> a.z - b.z);

  // pulse rings
  if(pulseStart > 0 && chosenIndex >= 0 && (mode==="highlight" || mode==="reveal")){
    const elapsed = (now - pulseStart)/1000;
    if(elapsed < 0.9){
      const chosen = flowerDraw.find(f=>f.i===chosenIndex);
      if(chosen){
        const t = clamp(elapsed/0.9,0,1);
        const e = easeOutCubic(t);
        const r1 = R*(0.06 + 0.22*e);
        const r2 = R*(0.10 + 0.30*e);
        ctx.save();
        ctx.globalAlpha = (1 - t) * 0.70;
        ctx.strokeStyle = `rgba(232,197,106,${0.30*(1-t)})`;
        ctx.lineWidth = Math.max(1, 1.2*DPR);
        ctx.beginPath(); ctx.arc(chosen.x, chosen.y, r1, 0, Math.PI*2); ctx.stroke();
        ctx.strokeStyle = `rgba(246,230,194,${0.18*(1-t)})`;
        ctx.lineWidth = Math.max(1, 1.0*DPR);
        ctx.beginPath(); ctx.arc(chosen.x, chosen.y, r2, 0, Math.PI*2); ctx.stroke();
        ctx.restore();
      }
    }else pulseStart = -1;
  }

  // draw flowers
  for(const f of flowerDraw){
    const idx = f.i;
    const frontFade = f.front ? 1 : 0.62;

    const isUsed = usedFlowers.has(idx);
    let usedFade = 1.0;
    if(isUsed){
      const t0 = usedAt.get(idx) ?? now;
      const cool = clamp((now - t0)/1200, 0, 1);
      usedFade = lerp(0.95, 0.28, easeOutCubic(cool));
    }

    let othersFade = 1;
    if(chosenIndex>=0 && idx !== chosenIndex){
      if(mode==="highlight"){
        othersFade = lerp(1, 0.28, easeOutCubic(highlightT));
      }else if(mode==="reveal"){
        othersFade = lerp(0.28, 0.12, easeOutCubic(revealT));
      }
    }

    const alpha = clamp(0.98 * frontFade * usedFade * othersFade, 0, 1);
    let size = (R*0.070) * f.k;
    if(idx===chosenIndex){
      if(mode==="highlight"){
        size *= (1.0 + 0.12*easeOutCubic(highlightT));
      }else if(mode==="reveal"){
        size *= (1.0 + 0.12 + 0.18*easeOutCubic(revealT));
      }
    }
    const petalColor = flowers[idx].hue;

    drawFlower(f.x, f.y, size, petalColor, alpha, isUsed, (idx===chosenIndex && mode==="reveal"));
  }

  // show paper
  if(mode==="reveal" && chosenIndex>=0){
    const t = easeOutCubic(revealT);
    if(t > 0.1 && !paper.classList.contains('show')){
      showPaper(currentLetter || TEMPLATE_LETTER);
    }
  }

  requestAnimationFrame(draw);
}
requestAnimationFrame(draw);
</script>
</body>
</html>
